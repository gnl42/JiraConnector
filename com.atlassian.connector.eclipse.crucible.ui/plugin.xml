<plugin>
	<extension point="org.eclipse.mylyn.tasks.ui.repositories">
		<connectorCore class="com.atlassian.connector.eclipse.internal.crucible.core.CrucibleRepositoryConnector" id="crucible" name="Crucible">
		</connectorCore>
		<connectorUi brandingIcon="icons/obj16/crucible.png" class="com.atlassian.connector.eclipse.internal.crucible.ui.CrucibleRepositoryConnectorUi" id="crucible" name="Crucible" overlayIcon="icons/obj16/crucible-overlay.png">
		</connectorUi>
	</extension>
	<extension point="org.eclipse.mylyn.tasks.ui.editors">
		<pageFactory class="com.atlassian.connector.eclipse.internal.crucible.ui.CrucibleEditorPageFactory" id="com.atlassian.connector.eclipse.internal.crucible.ui.crucible.edior.factory">
		</pageFactory>
	</extension>

	<!-- Menus -->
	<extension point="org.eclipse.ui.popupMenus">		
		<objectContribution
            objectClass="com.atlassian.connector.eclipse.ui.commons.IEditorResource"
            adaptable="true"
            id="com.atlassian.connector.eclipse.crucible.ui.ReviewResource2">
         <action
               class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.CreateReviewFromResourcesAction"
               id="com.atlassian.connector.eclipse.internal.crucible.ui.CreateReviewAction2"
               menubarPath="team.main/group10"
               icon="icons/obj16/crucible.png"
               label="Create Review"
               tooltip="Create Review">
         </action>
      </objectContribution>
	</extension>

	<extension id="com.atlassian.connector.eclipse.crucible.ui.popup" name="Crucible Review Actions" point="org.eclipse.ui.popupMenus">
		<objectContribution adaptable="true" id="com.atlassian.connector.eclipse.internal.crucible.ui.createReviewContribution" 
			objectClass="com.atlassian.connector.eclipse.team.ui.ICustomChangesetLogEntry">

			<action class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.CreateReviewAction" 
				enablesFor="+" id="com.atlassian.connector.eclipse.internal.crucible.ui.createReviewAction" 
				label="Create Review..." menubarPath="mylyn" style="push" tooltip="Create a review from the selected Revision">
			</action>

		</objectContribution>
		<objectContribution id="com.atlassian.connector.eclipse.crucible.ui.objectContribution1" objectClass="org.eclipse.ui.IEditorInput">
			<action class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.AddLineCommentToFileAction" 
				enablesFor="1" icon="icons/obj16/pin_addcomment.png" id="com.atlassian.connector.eclipse.crucible.ui.action.add.line.comment" 
				label="Comment on Selected Lines..." menubarPath="group.undo" tooltip="Add Line Comment to Active Review">
			</action>
			<action class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.AddGeneralCommentToFileAction" 
				enablesFor="1" id="com.atlassian.connector.eclipse.crucible.ui.action.add.file.comment" 
				label="Add General File Comment..." menubarPath="group.undo" tooltip="Add Comment to Active Review">
			</action>
			<visibility>
				<systemProperty name="com.atlassian.connector.eclipse.crucible.ui.review.active" value="true"/>
			</visibility>
		</objectContribution>
		
		<objectContribution id="com.atlassian.connector.eclipse.crucible.ui.objectContribution2" 
			objectClass="com.atlassian.connector.eclipse.ui.commons.IEditorResource" adaptable="true">
			<action class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.AddResourceToActiveReviewAction" 
				id="com.atlassian.connector.eclipse.crucible.ui.action.add.fileToReview" 
				label="Add to Active Review" menubarPath="team.main/group10" tooltip="Add to Active Review">
			</action>
			<visibility>
				<systemProperty name="com.atlassian.connector.eclipse.crucible.ui.review.active" value="true"/>
			</visibility>
		</objectContribution>
	</extension>
	
	<extension point="org.eclipse.ui.editors.annotationTypes">
		<type name="com.atlassian.connector.eclipse.cruicible.ui.comment.annotation"/>
	</extension>
	
	<extension point="org.eclipse.ui.editors.markerAnnotationSpecification">
		<specification annotationType="com.atlassian.connector.eclipse.cruicible.ui.comment.annotation" 
			colorPreferenceKey="comment_color" 
			colorPreferenceValue="179,215,255" 
			contributesToHeader="true" 
			highlightPreferenceKey="comment_highlight" 
			highlightPreferenceValue="true" 
			icon="/icons/obj16/crucible.png" 
			includeOnPreferencePage="true" 
			isGoToNextNavigationTarget="false" 
			isGoToNextNavigationTargetKey="comment_isGoToNextNavigationTargetKey" 
			isGoToPreviousNavigationTarget="false" 
			isGoToPreviousNavigationTargetKey="commet_isGoToPreviousNavigationTargetKey" 
			label="Active Review Comments" 
			overviewRulerPreferenceKey="comment_overviewRuler" 
			overviewRulerPreferenceValue="true" 
			presentationLayer="0" 
			showInNextPrevDropdownToolbarAction="false" 
			showInNextPrevDropdownToolbarActionKey="comment_showInNextPrevDropdownToolbarAction" 
			textPreferenceKey="comment_text" 
			textPreferenceValue="true" 
			textStylePreferenceKey="comment_stylePreferences" 
			textStylePreferenceValue="BOX" 
			verticalRulerPreferenceKey="comment_verticalRuler" 
			verticalRulerPreferenceValue="true" />
	</extension>
	
	<extension point="org.eclipse.ui.preferencePages">
		<page category="com.atlassian.connector.eclipse.ui.preferences.AtlassianPreferencePage" 
			class="com.atlassian.connector.eclipse.crucible.ui.preferences.CruciblePreferencePage" 
			id="com.atlassian.connector.eclipse.crucible.ui.CruciblePreferencePage" name="Crucible">
		</page>
	</extension>
	<extension point="org.eclipse.core.runtime.preferences">
		<initializer class="com.atlassian.connector.eclipse.crucible.ui.preferences.PreferenceInitializer">
		</initializer>
	</extension>
	
	<extension point="org.eclipse.ui.views">
		<category
			id="com.atlassian.connector.eclipse.ui.category" name="Atlassian">
		</category>
		
		<view id="com.atlassian.connector.eclipse.crucible.ui.explorerView" 
			name="Review Explorer" class="com.atlassian.connector.eclipse.internal.crucible.ui.views.ReviewExplorerView" icon="icons/obj16/crucible.png" 
			category="com.atlassian.connector.eclipse.ui.category"/>
			
		<view id="com.atlassian.connector.eclipse.crucible.ui.commentView" 
			name="Review Comment" class="com.atlassian.connector.eclipse.internal.crucible.ui.views.CommentView" icon="icons/obj16/crucible.png" 
			category="com.atlassian.connector.eclipse.ui.category"/>
	</extension>
	
	<extension point="org.eclipse.ui.perspectives">
		<perspective name="Crucible Review" 
			class="com.atlassian.connector.eclipse.internal.crucible.ui.views.ReviewPerspective"
			id="com.atlassian.connector.eclipse.crucible.ui.reviewPerspective"
			icon="icons/obj16/crucible.png">
		</perspective>
	</extension>
	
   <extension point="org.eclipse.ui.decorators">
      <decorator
            class="com.atlassian.connector.eclipse.internal.crucible.ui.decoration.CommentDecorator"
            id="com.atlassian.connector.eclipse.internal.crucible.ui.decoration.CommentDecorator"
            label="Crucible Comment Defect Decorator"
            lightweight="true"
            state="true">
         <enablement>
               <objectClass
                     name="com.atlassian.theplugin.commons.crucible.api.model.Comment">
               </objectClass>
         </enablement>
      </decorator>
      <decorator
            class="com.atlassian.connector.eclipse.internal.crucible.ui.decoration.CrucibleFileInfoDecorator"
            id="com.atlassian.connector.eclipse.internal.crucible.ui.decoration.CrucibleFileInfoDecorator"
            label="Crucible File State Decorator"
            lightweight="true"
            state="true">
         <enablement>
               <objectClass
                     name="com.atlassian.theplugin.commons.crucible.api.model.CrucibleFileInfo">
               </objectClass>
         </enablement>
      </decorator>
   </extension>
   
   <extension
         point="org.eclipse.core.runtime.adapters">
         <!-- I declare that I can adapt from IAdaptable in order actually to make it work in as many contexts as possible -
         not only for instanceofs IResource, but also for CompilationUnit, IJavaProject, etc. which do adapt to IResource, but 
         do not implement this interface. It also handles IEditorInput -->
      <factory
            adaptableType="org.eclipse.core.runtime.IAdaptable"
            class="com.atlassian.connector.eclipse.ui.commons.EditorResourceAdapterFactory">
         <adapter
               type="com.atlassian.connector.eclipse.ui.commons.IEditorResource">
         </adapter>
      </factory>
   </extension>
   
	<extension point="org.eclipse.ui.workbench.texteditor.rulerColumns">
		<column id="com.atlassian.connector.eclipse.crucible.ui.editor.annotationRuler" name="Crucible Comments"
			icon="/icons/obj16/crucible.png"
			class="com.atlassian.connector.eclipse.internal.crucible.ui.editor.ruler.CommentAnnotationRulerColumn"
			enabled="true"
			global="true"
			includeInMenu="true">
			
			<placement gravity="1.0">
				<!--<after id="org.eclipse.ui.editors.columns.annotations"/> -->
			</placement>
			
			<targetClass class="org.eclipse.ui.texteditor.AbstractDecoratedTextEditor" />
		</column>
	</extension>   
</plugin>
