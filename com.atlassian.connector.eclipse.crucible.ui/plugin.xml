<plugin>
	<extension point="org.eclipse.mylyn.tasks.ui.repositories">
		<connectorCore class="com.atlassian.connector.eclipse.internal.crucible.core.CrucibleRepositoryConnector" id="crucible" name="Crucible">
		</connectorCore>
		<connectorUi brandingIcon="icons/obj16/crucible.png" class="com.atlassian.connector.eclipse.internal.crucible.ui.CrucibleRepositoryConnectorUi" id="crucible" name="Crucible" overlayIcon="icons/obj16/crucible-overlay.png">
		</connectorUi>
	</extension>
	<extension point="org.eclipse.mylyn.tasks.ui.editors">
		<pageFactory class="com.atlassian.connector.eclipse.internal.crucible.ui.CrucibleEditorPageFactory" id="com.atlassian.connector.eclipse.internal.crucible.ui.crucible.edior.factory">
		</pageFactory>
	</extension>
	<extension point="org.eclipse.ui.editors.markerAnnotationSpecification">
		<specification annotationType="com.atlassian.connector.eclipse.cruicible.ui.comment.annotation" colorPreferenceKey="comment_color" colorPreferenceValue="255,231,198" contributesToHeader="true" highlightPreferenceKey="comment_highlight" highlightPreferenceValue="true" icon="/icons/obj16/crucible.png" includeOnPreferencePage="true" isGoToNextNavigationTarget="true" isGoToNextNavigationTargetKey="comment_isGoToNextNavigationTargetKey" isGoToPreviousNavigationTarget="true" isGoToPreviousNavigationTargetKey="commet_isGoToPreviousNavigationTargetKey" label="Active Review Comments" overviewRulerPreferenceKey="comment_overviewRuler" overviewRulerPreferenceValue="true" presentationLayer="0" showInNextPrevDropdownToolbarAction="true" showInNextPrevDropdownToolbarActionKey="comment_showInNextPrevDropdownToolbarAction" textPreferenceKey="comment_text" textPreferenceValue="true" textStylePreferenceKey="comment_stylePreferences" textStylePreferenceValue="BOX" verticalRulerPreferenceKey="comment_verticalRuler" verticalRulerPreferenceValue="true" />
	</extension>

	<!-- Menus -->
	<extension point="org.eclipse.ui.popupMenus">		
		<objectContribution
            objectClass="com.atlassian.connector.eclipse.ui.commons.IEditorResource"
            adaptable="true"
            id="com.atlassian.connector.eclipse.crucible.ui.ReviewResource2">
         <action
               class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.CreateReviewFromResourcesAction"
               id="com.atlassian.connector.eclipse.internal.crucible.ui.CreateReviewAction2"
               menubarPath="team.main/group10"
               icon="icons/obj16/crucible.png"
               label="Create Review"
               tooltip="Create Review">
         </action>
      </objectContribution>
	</extension>

	<extension id="com.atlassian.connector.eclipse.crucible.ui.popup" name="Crucible Review Actions" point="org.eclipse.ui.popupMenus">
		<objectContribution adaptable="true" id="com.atlassian.connector.eclipse.internal.crucible.ui.createReviewContribution" objectClass="com.atlassian.connector.eclipse.team.ui.ICustomChangesetLogEntry">

			<action class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.CreateReviewAction" enablesFor="+" id="com.atlassian.connector.eclipse.internal.crucible.ui.createReviewAction" label="Create Review..." menubarPath="mylyn" style="push" tooltip="Create a review from the selected Revision">
			</action>

		</objectContribution>
		<objectContribution id="com.atlassian.connector.eclipse.crucible.ui.objectContribution1" objectClass="org.eclipse.ui.IEditorInput">
			<action class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.AddLineCommentToFileAction" enablesFor="1" icon="icons/obj16/pin_addcomment.png" id="com.atlassian.connector.eclipse.crucible.ui.action.add.line.comment" label="Comment on Selected Lines..." menubarPath="group.undo" tooltip="Add Line Comment to Active Review">
			</action>
			<action class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.AddGeneralCommentToFileAction" enablesFor="1" id="com.atlassian.connector.eclipse.crucible.ui.action.add.file.comment" label="Add General File Comment..." menubarPath="group.undo" tooltip="Add Comment to Active Review">
			</action>
			<action class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.AddResourceToActiveReviewAction" enablesFor="1" id="com.atlassian.connector.eclipse.crucible.ui.action.add.fileToReview" label="Add File to Active Review" menubarPath="group.undo" tooltip="Add File to Active Review">
			</action>
			<visibility>
				<systemProperty name="com.atlassian.connector.eclipse.crucible.ui.review.active" value="true">
				</systemProperty>
			</visibility>
		</objectContribution>
		<objectContribution id="com.atlassian.connector.eclipse.crucible.ui.objectContribution2" objectClass="org.eclipse.core.resources.IResource" adaptable="true">
			<action class="com.atlassian.connector.eclipse.internal.crucible.ui.actions.AddResourceToActiveReviewAction" id="com.atlassian.connector.eclipse.crucible.ui.action.add.fileToReview" label="Add Files to Active Review" menubarPath="team.main/group10" tooltip="Add Files to Active Review">
			</action>
			<visibility>
				<systemProperty name="com.atlassian.connector.eclipse.crucible.ui.review.active" value="true">
				</systemProperty>
			</visibility>
		</objectContribution>
	</extension>
	<extension point="org.eclipse.ui.editors.annotationTypes">
		<type markerType="com.atlassian.connector.eclipse.crucible.ui.com.atlassian.connector.eclipse.cruicible.ui.comment.marker" name="com.atlassian.connector.eclipse.cruicible.ui.comment.annotation">
		</type>
	</extension>
	<extension id="com.atlassian.connector.eclipse.cruicible.ui.comment.marker" point="org.eclipse.core.resources.markers">
	</extension>

	<extension point="org.eclipse.ui.preferencePages">
		<page category="com.atlassian.connector.eclipse.ui.preferences.AtlassianPreferencePage" class="com.atlassian.connector.eclipse.crucible.ui.preferences.CruciblePreferencePage" id="com.atlassian.connector.eclipse.crucible.ui.CruciblePreferencePage" name="Crucible">
		</page>
	</extension>
	<extension point="org.eclipse.core.runtime.preferences">
		<initializer class="com.atlassian.connector.eclipse.crucible.ui.preferences.PreferenceInitializer">
		</initializer>
	</extension>
	
	<extension point="org.eclipse.ui.views">
		<category
			id="com.atlassian.connector.eclipse.ui.category" name="Atlassian">
		</category>
		
		<view id="com.atlassian.connector.eclipse.crucible.ui.explorerView" 
			name="Review Explorer" class="com.atlassian.connector.eclipse.internal.crucible.ui.views.ReviewExplorerView" icon="icons/obj16/crucible.png" 
			category="com.atlassian.connector.eclipse.ui.category"/>
			
		<view id="com.atlassian.connector.eclipse.crucible.ui.commentView" 
			name="Review Comment" class="com.atlassian.connector.eclipse.internal.crucible.ui.views.CommentView" icon="icons/obj16/crucible.png" 
			category="com.atlassian.connector.eclipse.ui.category"/>
	</extension>
	
	<extension point="org.eclipse.ui.perspectives">
		<perspective name="Crucible Review" 
			class="com.atlassian.connector.eclipse.internal.crucible.ui.views.ReviewPerspective"
			id="com.atlassian.connector.eclipse.crucible.ui.reviewPerspective"
			icon="icons/obj16/crucible.png">
		</perspective>
	</extension>
	
   <extension point="org.eclipse.ui.decorators">
      <decorator
            class="com.atlassian.connector.eclipse.internal.crucible.ui.decoration.CommentDecorator"
            id="com.atlassian.connector.eclipse.internal.crucible.ui.decoration.CommentDecorator"
            label="Crucible Comment Defect Decorator"
            lightweight="true"
            state="true">
         <enablement>
               <objectClass
                     name="com.atlassian.theplugin.commons.crucible.api.model.Comment">
               </objectClass>
         </enablement>
      </decorator>
      <decorator
            class="com.atlassian.connector.eclipse.internal.crucible.ui.decoration.CrucibleFileInfoDecorator"
            id="com.atlassian.connector.eclipse.internal.crucible.ui.decoration.CrucibleFileInfoDecorator"
            label="Crucible File State Decorator"
            lightweight="true"
            state="true">
         <enablement>
               <objectClass
                     name="com.atlassian.theplugin.commons.crucible.api.model.CrucibleFileInfo">
               </objectClass>
         </enablement>
      </decorator>
   </extension>
   
   <extension
         point="org.eclipse.core.runtime.adapters">
         <!-- I declare that I can adapt from IAdaptable in order actually to make it work in as many contexts as possible -
         not only for instanceofs IResource, but also for CompilationUnit, IJavaProject, etc. which do adapt to IResource, but 
         do not implement this interface. It also handles IEditorInput -->
      <factory
            adaptableType="org.eclipse.core.runtime.IAdaptable"
            class="com.atlassian.connector.eclipse.ui.commons.EditorResourceAdapterFactory">
         <adapter
               type="com.atlassian.connector.eclipse.ui.commons.IEditorResource">
         </adapter>
      </factory>
   </extension>
   
</plugin>
